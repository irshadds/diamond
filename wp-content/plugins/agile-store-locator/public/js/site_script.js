jQuery(document).ready(function(){window._asl_map_customize||(window._asl_map_customize=null);var asl_locator=function(){};if(window.asl_locator=asl_locator,window.google&&google.maps){InfoBox.prototype=new google.maps.OverlayView,InfoBox.prototype.createInfoBoxDiv_=function(){var t,e,o,i=this,a=function(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()};if(!this.div_){if(this.div_=document.createElement("div"),this.setBoxStyle_(),void 0===this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(o=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-o.left-o.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),!this.enableEventPropagation_){for(this.eventListeners_=[],e=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],t=0;t<e.length;t++)this.eventListeners_.push(google.maps.event.addDomListener(this.div_,e[t],a));this.eventListeners_.push(google.maps.event.addDomListener(this.div_,"mouseover",function(t){this.style.cursor="default"}))}this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",function(t){t.returnValue=!1,t.preventDefault&&t.preventDefault(),i.enableEventPropagation_||a(t)}),google.maps.event.trigger(this,"domready")}},InfoBox.prototype.getCloseBoxImg_=function(){var t="";return""!==this.closeBoxURL_&&(t="<img",t+=" src='"+this.closeBoxURL_+"'",t+=" align=right",t+=" style='",t+=" position: relative;",t+=" cursor: pointer;",t+=" margin: "+this.closeBoxMargin_+";",t+="'>"),t},InfoBox.prototype.addClickHandler_=function(){var t;""!==this.closeBoxURL_?(t=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(t,"click",this.getCloseClickHandler_())):this.closeListener_=null},InfoBox.prototype.getCloseClickHandler_=function(){var e=this;return function(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),google.maps.event.trigger(e,"closeclick"),e.close()}},InfoBox.prototype.panBox_=function(t){var e,o=0,i=0;if(!t&&(e=this.getMap())instanceof google.maps.Map){e.getBounds().contains(this.position_)||e.setCenter(this.position_),e.getBounds();var a=e.getDiv(),s=a.offsetWidth,n=a.offsetHeight,r=this.pixelOffset_.width,l=this.pixelOffset_.height,_=this.div_.offsetWidth,c=this.div_.offsetHeight,d=this.infoBoxClearance_.width,p=this.infoBoxClearance_.height,g=this.getProjection().fromLatLngToContainerPixel(this.position_);if(g.x<-r+d?o=g.x+r-d:g.x+_+r+d>s&&(o=g.x+_+r+d-s),this.alignBottom_?g.y<-l+p+c?i=g.y+l-p-c:g.y+l+p>n&&(i=g.y+l+p-n):g.y<-l+p?i=g.y+l-p:g.y+c+l+p>n&&(i=g.y+c+l+p-n),0!==o||0!==i){e.getCenter();e.panBy(o,i)}}},InfoBox.prototype.setBoxStyle_=function(){var t,e;if(this.div_){for(t in this.div_.className=this.boxClass_,this.div_.style.cssText="",e=this.boxStyle_)e.hasOwnProperty(t)&&(this.div_.style[t]=e[t]);this.div_.style.WebkitTransform="translateZ(0)",void 0!==this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+100*this.div_.style.opacity+')"',this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},InfoBox.prototype.getBoxWidths_=function(){var t,e={top:0,bottom:0,left:0,right:0},o=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(t=o.ownerDocument.defaultView.getComputedStyle(o,""))&&(e.top=parseInt(t.borderTopWidth,10)||0,e.bottom=parseInt(t.borderBottomWidth,10)||0,e.left=parseInt(t.borderLeftWidth,10)||0,e.right=parseInt(t.borderRightWidth,10)||0):document.documentElement.currentStyle&&o.currentStyle&&(e.top=parseInt(o.currentStyle.borderTopWidth,10)||0,e.bottom=parseInt(o.currentStyle.borderBottomWidth,10)||0,e.left=parseInt(o.currentStyle.borderLeftWidth,10)||0,e.right=parseInt(o.currentStyle.borderRightWidth,10)||0),e},InfoBox.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},InfoBox.prototype.draw=function(){this.createInfoBoxDiv_();var t=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=t.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(t.y+this.pixelOffset_.height)+"px":this.div_.style.top=t.y+this.pixelOffset_.height+"px",this.isHidden_?this.div_.style.visibility="hidden":this.div_.style.visibility="visible"},InfoBox.prototype.setOptions=function(t){void 0!==t.boxClass&&(this.boxClass_=t.boxClass,this.setBoxStyle_()),void 0!==t.boxStyle&&(this.boxStyle_=t.boxStyle,this.setBoxStyle_()),void 0!==t.content&&this.setContent(t.content),void 0!==t.disableAutoPan&&(this.disableAutoPan_=t.disableAutoPan),void 0!==t.maxWidth&&(this.maxWidth_=t.maxWidth),void 0!==t.pixelOffset&&(this.pixelOffset_=t.pixelOffset),void 0!==t.alignBottom&&(this.alignBottom_=t.alignBottom),void 0!==t.position&&this.setPosition(t.position),void 0!==t.zIndex&&this.setZIndex(t.zIndex),void 0!==t.closeBoxMargin&&(this.closeBoxMargin_=t.closeBoxMargin),void 0!==t.closeBoxURL&&(this.closeBoxURL_=t.closeBoxURL),void 0!==t.infoBoxClearance&&(this.infoBoxClearance_=t.infoBoxClearance),void 0!==t.isHidden&&(this.isHidden_=t.isHidden),void 0!==t.visible&&(this.isHidden_=!t.visible),void 0!==t.enableEventPropagation&&(this.enableEventPropagation_=t.enableEventPropagation),this.div_&&this.draw()},InfoBox.prototype.setContent=function(t){this.content_=t,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),void 0===t.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+t:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(t)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px",void 0===t.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+t:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(t))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},InfoBox.prototype.setPosition=function(t){this.position_=t,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},InfoBox.prototype.setZIndex=function(t){this.zIndex_=t,this.div_&&(this.div_.style.zIndex=t),google.maps.event.trigger(this,"zindex_changed")},InfoBox.prototype.setVisible=function(t){this.isHidden_=!t,this.div_&&(this.div_.style.visibility=this.isHidden_?"hidden":"visible")},InfoBox.prototype.getContent=function(){return this.content_},InfoBox.prototype.getPosition=function(){return this.position_},InfoBox.prototype.getZIndex=function(){return this.zIndex_},InfoBox.prototype.getVisible=function(){return void 0!==this.getMap()&&null!==this.getMap()&&!this.isHidden_},InfoBox.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},InfoBox.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},InfoBox.prototype.open=function(t,e){var o=this;e&&(this.position_=e.getPosition(),this.moveListener_=google.maps.event.addListener(e,"position_changed",function(){o.setPosition(this.getPosition())})),this.setMap(t),this.div_&&this.panBox_()},InfoBox.prototype.close=function(){var t;if(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListeners_){for(t=0;t<this.eventListeners_.length;t++)google.maps.event.removeListener(this.eventListeners_[t]);this.eventListeners_=null}this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)};var asl_drawing={shapes:[],shapes_index:0,current_map:null,loadData:function(t,e){var o=this;for(var i in o.current_map=e,t.shapes)t.shapes[i]&&("polygon"==t.shapes[i].type?o.shapes.push(o.create_polygon.call(o,t.shapes[i].coord,e,t.shapes[i])):"circle"==t.shapes[i].type?o.shapes.push(o.create_circle.call(o,t.shapes[i],e)):"rectangle"==t.shapes[i].type&&o.shapes.push(o.create_rectangle.call(o,t.shapes[i],e)))},create_rectangle:function(t){var e=this.current_map;return new google.maps.Rectangle({strokeColor:t.strokeColor,fillColor:t.color,strokeWeight:1,type:"rectangle",editable:!!asl_drawing.allow_edit&&asl_drawing.allow_edit,map:e,bounds:new google.maps.LatLngBounds(new google.maps.LatLng(t.sw[0],t.sw[1]),new google.maps.LatLng(t.ne[0],t.ne[1]))})},create_circle:function(t,e){e=this.current_map;return new google.maps.Circle({strokeColor:t.strokeColor,fillColor:t.color,type:"circle",strokeWeight:1,map:e,editable:!!asl_drawing.allow_edit&&asl_drawing.allow_edit,center:new google.maps.LatLng(t.center[0],t.center[1]),radius:t.radius})},create_polygon:function(t,e,o){e=this.current_map;var i=[];for(var a in t)i.push({lat:t[a][0],lng:t[a][1]});return new google.maps.Polygon({paths:i,fillColor:o.color,strokeColor:o.strokeColor,strokeWeight:1,editable:!!asl_drawing.allow_edit,type:"polygon",map:e})}};!function(g){g.templates||(g.templates=asl_jQuery.templates);var i=!1;asl_locator.add_prop_search=function(t,r){var e=g(r),o=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("title"),queryTokenizer:Bloodhound.tokenizers.whitespace,local:t});e.val(""),e.bind("keydown",function(t){13==t.which&&(e.parent().find(".tt-suggestion.tt-cursor")[0]?e.parent().find(".tt-suggestion.tt-cursor").trigger("click"):e.parent().find(".tt-suggestion:first-child").trigger("click"))}),e.on("keyup",function(t){"asl-location-search"==this.id&&!t.target.value&&asl_view._location&&(asl_view._location=null,asl_view.refreshView(),asl_view._panel.stores_changed())}),"0"!=asl_configuration.search_type&&e.next().children().bind("click",function(){e.parent().find(".tt-suggestion:first-child").trigger("click")}),o.initialize(),e.typeahead({hint:!1,highlight:!0,minLength:1},{name:"title",displayKey:"title",source:o.ttAdapter()}),e.on("typeahead:selected",function(t,e,o){if(e.type){var i=new google.maps.LatLngBounds;for(var a in asl_view.data_.stores_)asl_view.data_.stores_.hasOwnProperty(a)&&asl_view.data_.stores_[a].props_[e.type]==e.title&&i.extend(asl_view.data_.stores_[a].getLocation());if(asl_view._location=e.title,"1"==asl_configuration.fit_bound)asl_map.fitBounds(i);else{var s=i.getCenter();asl_map.setCenter(s),asl_map.setZoom(parseInt(asl_configuration.search_zoom))}return asl_view.refreshView(),void r.next().removeClass("hide")}var n=g('.asl-p-cont .item[data-id="'+e.id+'"]');n[0]&&(n.trigger("click").addClass("highlighted"),"1"==asl_configuration.layout?n.parents("li").children(0).trigger("click"):g("#asl-storelocator #asl-list").animate({scrollTop:n.position().top},"fast"))})},asl_locator.toRad_=function(t){return t*Math.PI/180},asl_locator.Store=function(t,e,o,i){this.id_=t,this.location_=e,this.categories_=o,this.props_=i||{},this.v_id=i.vendor_id},asl_locator.Store.prototype.setMarker=function(t){this.marker_=t,google.maps.event.trigger(this,"marker_changed",t)},asl_locator.Store.prototype.getMarker=function(){return this.marker_},asl_locator.Store.prototype.getId=function(){return this.id_},asl_locator.Store.prototype.getLocation=function(){return this.location_},asl_locator.Store.prototype.hasCategory=function(t){return-1!=this.categories_.indexOf(t)},asl_locator.Store.prototype.hasAnyCategory=function(t){if(!t.array_.length)return!0;for(var e=t.asList(),o=0,i=e.length;o<i;o++)if(-1!=this.categories_.indexOf(e[o].id_))return!0;return!1},asl_locator.Store.prototype.getDetails=function(){return this.props_},asl_locator.Store.prototype.generateFieldsHTML_=function(t){for(var e=[],o=0,i=t.length;o<i;o++){var a=t[o];this.props_[a]&&(e.push('<div class="'),e.push(a),e.push('">'),e.push(a+": "),e.push(isNaN(this.props_[a])?this.props_[a]:numberWithCommas(this.props_[a])),e.push("</div>"))}return e.join("")},asl_locator.Store.prototype.generateFeaturesHTML_=function(){var t=[];t.push('<ul class="features">');for(var e,o=this.categories_.asList(),i=0;e=o[i];i++)t.push("<li>"),t.push(e.getDisplayName()),t.push("</li>");return t.push("</ul>"),t.join("")},asl_locator.Store.prototype.getStoreContent=function(){if(!this.content_){var t=window.asl_tmpl_list_item?window.asl_tmpl_list_item:g.templates(window.asl_info_list||"#tmpl_list_item");window.asl_tmpl_list_item=t,this.content_=g(t.render(this.props_))}return this.content_},asl_locator.Store.prototype.getcontent_=function(t){var e=window.asl_too_tip_tmpl?window.asl_too_tip_tmpl:g.templates(window.asl_info_box||"#asl_too_tip");return window.asl_too_tip_tmpl=e,t.props_.show_categories=asl_configuration.show_categories,t.props_.URL=asl_configuration.URL,e.render(t.props_)},asl_locator.Store.prototype.getInfoWindowContent=function(t){var e='<div class="infoWindow" id="style_2">';return e+=this.getcontent_(this),e+="</div>",this.content_=e,this.content_},asl_locator.Store.infoPanelCache_={},asl_locator.Store.prototype.getInfoPanelItem=function(){var t=asl_locator.Store.infoPanelCache_,e=this.id_;if(!t[e]){var o=this.getStoreContent();t[e]=o[0]}return t[e]},asl_locator.Store.prototype.distanceTo=function(t){var e=this.getLocation(),o=asl_locator.toRad_(e.lat()),i=asl_locator.toRad_(e.lng()),a=asl_locator.toRad_(t.lat()),s=a-o,n=asl_locator.toRad_(t.lng())-i,r=Math.sin(s/2)*Math.sin(s/2)+Math.cos(o)*Math.cos(a)*Math.sin(n/2)*Math.sin(n/2),l=6371*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)));return"Miles"==asl_configuration.distance_unit?.621371*l:l},asl_locator.View=function(t,e,o){this.map_=t,this.data_=e,this.settings_=g.extend({updateOnPan:!0,geolocation:!1,features:new asl_locator.FeatureSet},o),this.init_(),google.maps.event.trigger(this,"load"),this.set("featureFilter",new asl_locator.FeatureSet),asl_configuration.active_marker&&(this.active_marker={m:null,picon:null,icon:new google.maps.MarkerImage(asl_configuration.URL+"public/icon/"+asl_configuration.active_marker,null,null)})},asl_locator.View=asl_locator.View,asl_locator.View.prototype=new google.maps.MVCObject,asl_locator.View.prototype.measure_distance=function(t,e,o,i){var a=this,s=new google.maps.LatLng(t.lat(),t.lng());a._panel.dest_coords=a.dest_coords=s;var n=100,r=1e3,l=null;for(var _ in a.data_.stores_)if(a.data_.stores_.hasOwnProperty(_)){var c=a.data_.stores_[_].distanceTo(a.dest_coords);a.data_.stores_[_].content_=null,a.data_.stores_[_].props_.distance=c,a.data_.stores_[_].props_.dist_str=c.toFixed(2)+" "+asl_configuration.distance_unit,n<c&&(n=c),c<r&&(l=a.data_.stores_[_],r=c)}if(asl_configuration.radius_range=asl_configuration.fixed_radius?parseInt(asl_configuration.fixed_radius):Math.ceil(n),delete asl_locator.Store.infoPanelCache_,asl_locator.Store.infoPanelCache_={},a.my_marker)a.my_marker.setPosition(s);else{a.my_marker=new google.maps.Marker({title:asl_configuration.words.your_cur_loc,position:s,zIndex:0,animation:google.maps.Animation.DROP,draggable:!0,map:a.getMap()});var d=new google.maps.MarkerImage(asl_configuration.URL+"public/img/me-pin.png",null,null,null);a.my_marker.setIcon(d),a.my_marker.addListener("dragend",function(t){a.measure_distance(t.latLng)})}e&&"1"==asl_configuration.search_destin&&l&&(s=l.getLocation()),o||(a.getMap().setCenter(s),a.getMap().setZoom(asl_configuration.search_zoom?parseInt(asl_configuration.search_zoom):parseInt(asl_configuration.zoom)),google.maps.event.trigger(a,"load"),a.refreshView(!0))},asl_locator.View.prototype.reset_measure=function(t){var e=this;e._panel.dest_coords=e.dest_coords=null;var o=asl_configuration.radius_range;for(var i in e.data_.stores_)e.data_.stores_.hasOwnProperty(i)&&(e.data_.stores_[i].content_=null,e.data_.stores_[i].props_.dist_str=e.data_.stores_[i].props_.distance=null);asl_configuration.radius_range=asl_configuration.fixed_radius?parseInt(asl_configuration.fixed_radius):Math.round(o),delete asl_locator.Store.infoPanelCache_,asl_locator.Store.infoPanelCache_={},e.my_marker&&(e.my_marker.setMap(null),delete e.my_marker,e.my_marker=null),e.refreshView(!0),g(t).val("")},asl_locator.View.prototype.geolocate_=function(){var e=this;window.navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){e.measure_distance(new google.maps.LatLng(t.coords.latitude,t.coords.longitude))},function(t){var e=g('<div class="alert alert-danger asl-geo-err"></div>');switch(t.code){case t.PERMISSION_DENIED:e.html(t.message||"User denied the request for Geolocation.");break;case t.POSITION_UNAVAILABLE:e.html("Location information is unavailable.");break;case t.TIMEOUT:e.html("The request to get user location timed out.");break;case t.UNKNOWN_ERROR:e.html("An unknown error occurred.");break;default:e.html(t.message)}e.appendTo(".asl-p-cont .asl-map"),window.setTimeout(function(){e.remove()},5e3)},{maximumAge:6e4,timeout:1e4})},asl_locator.View.prototype.init_=function(){this.settings_.geolocation&&this.geolocate_(),this.markerCache_={};var t=asl_configuration.infobox_width||250;this.infoWindow_=new InfoBox({boxStyle:{width:t+"px",margin:"0 0 51px -"+t/2+"px"},alignBottom:!0,pane:!1,disableAutoPan:!0,closeBoxMargin:"7px 6px -21px 0",closeBoxURL:"https://www.google.com/intl/en_us/mapfiles/close.gif",infoBoxClearance:new google.maps.Size(1,1)});var e=this,o=this.getMap();this.set("updateOnPan",this.settings_.updateOnPan),google.maps.event.addListener(this.infoWindow_,"closeclick",function(){e.highlight(null)}),google.maps.event.addListener(o,"click",function(){e.highlight(null),e.infoWindow_.close()})},asl_locator.View.prototype.updateOnPan_changed=function(){this.updateOnPanListener_&&google.maps.event.removeListener(this.updateOnPanListener_);if(this.get("updateOnPan")&&this.getMap()){var t=this.getMap();this.updateOnPanListener_=google.maps.event.addListener(t,"dragend",function(t){asl_configuration.reset_button&&g(".asl-reset-map")[0]&&"block"!=g(".asl-reset-map")[0].style&&(g(".asl-reset-map")[0].style.display="block")})}},asl_locator.View.prototype.addStoreToMap=function(t){var e=this.getMarker(t);t.setMarker(e);var o=this;e.clickListener_=google.maps.event.addListener(e,asl_configuration.mouseover?"mouseover":"click",function(){o.marker_clicked=!0,o.marker_center=e.getPosition(),o.highlight(t,!1),_asl_map_customize&&1==_asl_map_customize.marker_animations&&e.setAnimation(google.maps.Animation.Xp)}),e.getMap()!=this.getMap()&&(e.setMap(this.getMap()),_asl_map_customize&&1==_asl_map_customize.marker_animations&&e.setAnimation(google.maps.Animation.Xp))},asl_locator.View.prototype.createMarker=function(t){var e=asl_configuration.URL+"public/icon/";return e+=asl_markers[t.props_.marker_id]&&asl_markers[t.props_.marker_id].icon||"default.png",new google.maps.Marker({title:t.props_.title,position:t.getLocation(),zIndex:t.props_.ordr||0,animation:_asl_map_customize&&1==_asl_map_customize.marker_animations?google.maps.Animation.BOUNCE:null,icon:new google.maps.MarkerImage(e,null,null,null,null)})},asl_locator.View.prototype.getMarker=function(t){var e=this.markerCache_,o=t.id_;return e[o]||(e[o]=this.createMarker(t)),e[o]},asl_locator.View.prototype.getInfoWindow=function(t,e){if(!t)return this.infoWindow_;var o=g(t.getInfoWindowContent(e));return this.infoWindow_.setContent(o[0]),this.infoWindow_},asl_locator.View.prototype.getViewFeatures=function(){return this.settings_.features},asl_locator.View.prototype.getFeatureById=function(t){if(!this.featureById_){this.featureById_={};for(var e,o=0;e=this.settings_.features[o];o++)this.featureById_[e.id_]=e}return this.featureById_[t]},asl_locator.View.prototype.featureFilter_changed=function(){google.maps.event.trigger(this,"featureFilter_changed",this.get("featureFilter")),this.get("stores")&&this.clearMarkers()},asl_locator.View.prototype.clearMarkers=function(){for(var t in this.markerCache_){this.markerCache_[t].setMap(null);var e=this.markerCache_[t].clickListener_;e&&google.maps.event.removeListener(e)}},asl_locator.View.prototype.doBounce=function(t,e){var o=t.getMarker();o.setAnimation(null),e&&o.setAnimation(google.maps.Animation.BOUNCE)},asl_locator.View.prototype.refreshView=function(t){var r=this,l=this.getMap().getBounds();console.log("CALLING REFRESH VIEW"),this.data_.getStores(l,this.get("featureFilter"),function(t){var e=r.get("stores");if(e)for(var o=0,i=e.length;o<i;o++)google.maps.event.removeListener(e[o].getMarker().clickListener_);var a=[],s=[];asl_configuration.distance_slider&&t&&t[0]&&t[0].props_.dist_str;for(var n in t)t.hasOwnProperty(n)&&(0<t[n].props_.ordr?s.push(t[n]):a.push(t[n]));0<s.length&&r.data_.sortByDesc("ordr",s),asl_configuration.sort_by?r.data_.sortBy(asl_configuration.sort_by,a):a&&r.dest_coords?r.data_.sortDistance(r.dest_coords,a):l&&asl_configuration.sort_by_bound&&r.data_.sortDistance(l.getCenter(),a),0<s.length&&(a=s.concat(a)),asl_configuration.stores_limit&&(a=a.slice(0,asl_configuration.stores_limit)),r.set("stores",a)},t)},asl_locator.View.prototype.stores_changed=function(){var t=this.get("stores"),e=[];"1"!=asl_configuration.cluster&&this.clearMarkers();for(var o,i=0;o=t[i];i++)this.addStoreToMap(o),e.push(o.marker_);"1"==asl_configuration.cluster&&(asl_locator.marker_clusters.clearMarkers(),asl_locator.marker_clusters.addMarkers(e)),"1"!=asl_configuration.load_all&&this._panel.stores_changed()},asl_locator.View.prototype.getMap=function(){return this.map_},asl_locator.View.prototype.map_recenter=function(t,e,o){var i=this.getMap(),a=i.getProjection().fromLatLngToPoint(t instanceof google.maps.LatLng?t:i.getCenter()),s=new google.maps.Point(("number"==typeof e?e:0)/Math.pow(2,i.getZoom())||0,("number"==typeof o?o:0)/Math.pow(2,i.getZoom())||0);i.setCenter(i.getProjection().fromPointToLatLng(new google.maps.Point(a.x-s.x,a.y+s.y)))},asl_locator.View.prototype.highlight=function(t,e){var o=null,i=this.getMap();if(t){var a=this.get("stores");if(o=this.getInfoWindow(t,a),!e){var s=g('.asl-p-cont .item[data-id="'+t.id_+'"]');s[0]&&g("#asl-storelocator #asl-list").animate({scrollTop:s.position().top},"fast")}if(t.getMarker()){t.getMarker();o.open(i,t.getMarker())}else o.setPosition(t.getLocation()),o.open(i);if(asl_configuration.smooth_pan&&!e){var n=this._overlay.getProjection().fromLatLngToContainerPixel(t.getLocation());i.panBy(n.x-asl_configuration.info_x_offset-this.map_w/2,n.y-asl_configuration.info_y_offset-this.map_h/2)}else i.setZoom(parseInt(asl_configuration.zoom_li)),this.map_recenter(t.getLocation(),asl_configuration.info_x_offset,asl_configuration.info_y_offset);i.getStreetView().getVisible()&&i.getStreetView().setPosition(t.getLocation()),asl_configuration.highlight_first&&this._panel.stores_changed(t)}else this.getInfoWindow().close();this.set("selectedStore",t)},asl_locator.View.prototype.selectedStore_changed=function(){google.maps.event.trigger(this,"selectedStore_changed",this.get("selectedStore"))},asl_locator.ViewOptions=function(){},asl_locator.ViewOptions.prototype.updateOnPan,asl_locator.ViewOptions.prototype.geolocation,asl_locator.ViewOptions.prototype.features,asl_locator.ViewOptions.prototype.markerIcon,asl_locator.Feature=function(t,e,o,i){this.id_=t,this.name_=e,this.img_=o,this.s=i},asl_locator.Feature=asl_locator.Feature,asl_locator.Feature.prototype.getId=function(){return this.id_},asl_locator.Feature.prototype.getDisplayName=function(){return this.name_},asl_locator.Feature.prototype.toString=function(){return this.getDisplayName()},asl_locator.FeatureSet=function(t){this.array_=[],this.hash_={};for(var e,o=0;e=arguments[o];o++)this.add(e)},asl_locator.FeatureSet=asl_locator.FeatureSet,asl_locator.FeatureSet.prototype.toggle=function(t){this.hash_[t.id_]?this.remove(t):this.add(t)},asl_locator.FeatureSet.prototype.add=function(t){t&&(this.array_.push(t),this.hash_[t.id_]=1)},asl_locator.FeatureSet.prototype.remove=function(t){var e=t.id_;this.hash_[e]&&(delete this.hash_[e],this.array_=this.array_.filter(function(t){return t&&t.id_!=e}))},asl_locator.FeatureSet.prototype.asList=function(){for(var t=[],e=0,o=this.array_.length;e<o;e++){var i=this.array_[e];null!==i&&t.push(i)}return t},asl_locator.FeatureSet.NONE=new asl_locator.FeatureSet,asl_locator.Panel=function(t,e){this.el_=g(t),this.el_.addClass("asl_locator-panel"),this.settings_=g.extend({locationSearch:!0,locationSearchLabel:"Enter Location/ZipCode: ",featureFilter:!0,directions:!0,view:null},e),this.directionsRenderer_=new google.maps.DirectionsRenderer({draggable:!0}),this.directionsService_=new google.maps.DirectionsService,this.init_()},asl_locator.Panel=asl_locator.Panel,asl_locator.Panel.prototype=new google.maps.MVCObject,asl_locator.Panel.prototype.init_=function(){var i=this;this.itemCache_={},this.settings_.view&&this.set("view",this.settings_.view),this.filter_=g(".asl-p-cont .header-search");var t=i.get("view").getMap();"1"==asl_configuration.cluster&&(asl_locator.marker_clusters=new MarkerClusterer(t,[],{maxZoom:parseInt(asl_configuration.cluster_max_zoom)||9,gridSize:parseInt(asl_configuration.cluster_grid_size)||90,imagePath:asl_configuration.URL+"public/icon/m"})),this.settings_.locationSearch&&(this.locationSearch_=this.filter_,void 0!==google.maps.places?"0"==asl_configuration.search_type&&this.initAutocomplete_():this.filter_.submit(function(){i.searchPosition(g("input",i.locationSearch_).val())}),this.filter_.submit(function(){return!1}),google.maps.event.addListener(this,"geocode",function(t){if(i.searchPositionTimeout_&&window.clearTimeout(i.searchPositionTimeout_),t.geometry){this.directionsFrom_=t.geometry.location,i.directionsVisible_&&i.renderDirections_();var e=i.get("view");e.highlight(null);var o=e.getMap();t.geometry.viewport?o.fitBounds(t.geometry.viewport):(o.setCenter(t.geometry.location),o.setZoom(parseInt(asl_configuration.zoom_li))),e.refreshView(),i.listenForStoresUpdate_()}else i.searchPosition(t.name)}));this.storeList_=this.el_.find(".panel-inner"),this.directionsPanel_=g(".asl-p-cont #agile-modal-direction");var e=this.directionsPanel_.find(".frm-place");e.val(""),i.dest_coords&&(a.directionsFrom_=i.dest_coords);var o=this.directionsPanel_.find(".frm-place")[0];this.input_search=new google.maps.places.Autocomplete(o);var a=this;google.maps.event.addListener(this.input_search,"place_changed",function(){a.directionsFrom_=this.getPlace().geometry.location}),this.directionsPanel_.find(".directions-to").attr("readonly","readonly"),this.directionsVisible_=!1,this.directionsPanel_.find(".btn-submit").click(function(t){return i.dest_coords&&e.val()==asl_configuration.words.current_location&&(i.directionsFrom_=i.dest_coords||null),i.renderDirections_(),!1}),"KM"==asl_configuration.distance_unit?(i.distance_type=google.maps.UnitSystem.METRIC,i.directionsPanel_.find("#rbtn-km")[0].checked=!0):i.distance_type=google.maps.UnitSystem.IMPERIAL,i.directionsPanel_.find("input[name=dist-type]").change(function(){i.distance_type=1==this.value?google.maps.UnitSystem.IMPERIAL:google.maps.UnitSystem.METRIC}),this.el_.find(".directions-cont .close").click(function(){i.hideDirections(),g(".asl-p-cont .count-row").removeClass("hide"),g(".asl-p-cont #filter-options").removeClass("hide")}),this.directionsPanel_.find(".close-directions").click(function(){i.hideDirections(),g(".asl-p-cont .count-row").removeClass("hide"),g(".asl-p-cont #filter-options").removeClass("hide")})},asl_locator.Panel.prototype.toggleFeatureFilter_=function(t){var e=this.get("featureFilter");e.toggle(t),this.set("featureFilter",e)},asl_locator.geocoder_=new google.maps.Geocoder,asl_locator.Panel.prototype.listenForStoresUpdate_=function(){var t=this,e=this.get("view");this.storesChangedListener_&&google.maps.event.removeListener(this.storesChangedListener_),this.storesChangedListener_=google.maps.event.addListenerOnce(e,"stores_changed",function(){t.set("stores",e.get("stores"))})},asl_locator.Panel.prototype.searchPosition=function(t){var o=this,e={address:t,bounds:this.get("view").getMap().getBounds()};asl_locator.geocoder_.geocode(e,function(t,e){e==google.maps.GeocoderStatus.OK&&google.maps.event.trigger(o,"geocode",t[0])})},asl_locator.Panel.prototype.setView=function(t){this.set("view",t)},asl_locator.Panel.prototype.view_changed=function(){var t=this,e=this.get("view");this.bindTo("selectedStore",e),this.geolocationListener_&&google.maps.event.removeListener(this.geolocationListener_),this.zoomListener_&&google.maps.event.removeListener(this.zoomListener_),this.idleListener_&&google.maps.event.removeListener(this.idleListener_);e.getMap().getCenter();var o=function(){i||t.listenForStoresUpdate_()};this.geolocationListener_=google.maps.event.addListener(e,"load",o),this.zoomListener_=google.maps.event.addListener(e.getMap(),"zoom_changed",o),this.idleListener_=google.maps.event.addListener(e.getMap(),"idle",function(){return t.idle_(e.getMap())}),o(),this.bindTo("featureFilter",e),this.autoComplete_&&this.autoComplete_.bindTo("bounds",e.getMap())},asl_locator.Panel.prototype.geoCoder=function(o,i){var a=this,s=new google.maps.Geocoder;i=i||function(t,e){"OK"==e?(a.get("view").measure_distance(t[0].geometry.location,!0,null,t),"2"==asl_configuration.load_all&&g(".asl-reload-map").trigger("click"),g(o).next().removeClass("hide")):console.log("Geocode was not successful for the following reason: "+e)};g(o).bind("keyup",function(t){if(13==t.keyCode){var e=g.trim(this.value);e&&s.geocode({address:e},i)}}),asl_configuration.req_coords&&s.geocode({address:asl_configuration["default-addr"]},i),g(".asl-p-cont .icon-search").bind("click",function(t){var e=g.trim(o.value);e&&s.geocode({address:e},i)})},asl_locator.Panel.prototype.initAutocomplete_=function(){var e=this,o=g(".asl-p-cont #auto-complete-search,.asl-p-cont .asl-search-address")[0];if(!asl_configuration.geocoding_only){var t={};asl_configuration.google_search_type&&(t.types="cities"==asl_configuration.google_search_type||"regions"==asl_configuration.google_search_type?["("+asl_configuration.google_search_type+")"]:[asl_configuration.google_search_type]),asl_configuration.country_restrict&&(t.componentRestrictions={country:asl_configuration.country_restrict.toLowerCase()}),this.autoComplete_=new google.maps.places.Autocomplete(o,t),this.get("view")&&this.autoComplete_.bindTo("bounds",this.get("view").getMap()),google.maps.event.addListener(this.autoComplete_,"place_changed",function(){var t=this.getPlace();t.geometry&&(e.get("view").measure_distance(t.geometry.location,!0,null,t),g(o).next().removeClass("hide"),"2"==asl_configuration.load_all&&g(".asl-reload-map").trigger("click"))})}e.geoCoder(o)},asl_locator.Panel.prototype.idle_=function(t){this.center_?t.getBounds().contains(this.center_)||(this.center_=t.getCenter(),this.listenForStoresUpdate_()):this.center_=t.getCenter()},asl_locator.Panel.prototype.stores_changed=function(t){if(this.get("stores")){var o=this,e=this.get("view");if(!(e.showing_direction||asl_configuration.accordion&&e.is_updated)){e.is_updated=!0;var i=e&&e.getMap().getBounds(),a=e.get("stores"),s=this.get("selectedStore");if(asl_configuration.highlight_first&&t){for(var n=[],r=[],l=0;l<a.length;l++)a[l].id_==t.id_?n.push(a[l]):r.push(a[l]);a=n.concat(r)}asl_configuration.highlight_first&&t&&jQuery(".asl-p-cont #asl-list").animate({scrollTop:0},"fast"),asl_configuration.accordion||this.storeList_.empty(),a.length?(i&&i.contains(a[0].getLocation()),g(".asl-p-cont .Num_of_store .count-result").html(a.length)):(g(".asl-p-cont .Num_of_store .count-result").html("0"),o.storeList_.html('<div class="asl-overlay-on-item" id="asl-no-item-found"><div class="white"></div><h1 class="h1">'+asl_configuration.no_item_text+"</h1></div>"));for(var _=function(t){g(t.target).hasClass("s-direction")?t.preventDefault():"A"!=t.target.tagName&&(e.noRefreshList=!0,e.highlight(this.store,!0),asl_configuration.is_mob&&window.innerWidth<=480&&g("html, body").stop().animate({scrollTop:g(e.getMap().getDiv()).offset().top},900,"swing"))},c=0,d=a.length;c<d;c++){var p=a[c].getInfoPanelItem();p.store=a[c];a[c];s&&a[c].id_==s.id_&&g(p).addClass("highlighted"),p.clickHandler_||(p.clickHandler_=google.maps.event.addDomListener(p,"click",_)),p.addEventListener("mouseenter",e.doBounce.bind(e,a[c],!0)),p.addEventListener("mouseleave",e.doBounce.bind(e,a[c],!1)),g(p).find(".s-direction").click(function(t){var e=g(this).data("_store");o.directionsTo_=e,o.showDirections(e)}).data("_store",a[c]),o.storeList_.append(p)}}}},asl_locator.Panel.prototype.selectedStore_changed=function(){g(".highlighted",this.storeList_).removeClass("highlighted");var t=this,e=this.get("selectedStore"),o=t.get("view");if(o.active_marker&&o.active_marker.m&&(o.active_marker.m.setIcon(o.active_marker.picon),o.active_marker.m=null),e){var i=e.getMarker();o.active_marker&&(o.active_marker.picon=i.getIcon(),(o.active_marker.m=i).setIcon(o.active_marker.icon)),this.directionsTo_=e;var a=this.storeList_.find('div[data-id="'+e.id_+'"]');a&&a.addClass("highlighted"),this.settings_.directions&&this.directionsPanel_.find(".directions-to").val(e.getDetails().title);var s=t.get("view").getInfoWindow().getContent(),n=g("<a/>").text(asl_configuration.words.direction).attr("href","javascript:void(0)").addClass("action").addClass("directions"),r=g("<a/>").text(asl_configuration.words.zoom).attr("href","javascript:void(0)").addClass("action").addClass("zoomhere"),l=e.props_.website;if(n.click(function(){return t.showDirections(),!1}),r.click(function(){t.get("view").getMap().setOptions({center:e.getLocation(),zoom:asl_map.getZoom()+1})}),g(s).find(".asl-buttons").append(n).append(r),l){var _=g("<a/>").text(asl_configuration.words.detail).attr("href",l).addClass("action").addClass("a-website");"1"==asl_configuration.target_blank&&_.attr("target","_blank"),g(s).find(".asl-buttons").append(_)}}},asl_locator.Panel.prototype.hideDirections=function(){this.directionsVisible_=!1,this.directionsPanel_.removeClass("in"),this.el_.find(".directions-cont").addClass("hide"),this.storeList_.fadeIn(),this.directionsRenderer_.setMap(null),this.get("view").showing_direction=!1},asl_locator.Panel.prototype.showDirections=function(t){var e=this.get("selectedStore")||t;if(e){if(_isMobileDevice()&&"1"==asl_configuration.direction_redirect||"2"==asl_configuration.direction_redirect){var o=e.location_.lat()+","+e.location_.lng(),i="";return i=-1!=navigator.platform.indexOf("iPhone")||-1!=navigator.platform.indexOf("iPad")||-1!=navigator.platform.indexOf("iPod")?"https://maps.google.com/maps?daddr="+o+"&amp;ll=":"https://www.google.com/maps/dir/"+asl_configuration.words.cur_dir+"/"+o+"?hl=en",window.open(i,"_blank"),!0}this.directionsPanel_.find(".frm-place").val(this.dest_coords?asl_configuration.words.current_location:""),this.directionsPanel_.find(".directions-to").val(e.getDetails().title),this.directionsPanel_.addClass("in"),this.renderDirections_(),this.directionsVisible_=!0}},asl_locator.Panel.prototype.renderDirections_=function(){var i=this;if(this.directionsFrom_&&this.directionsTo_){this.el_.find("#map-loading").show(),this.el_.find(".directions-cont").removeClass("hide"),this.storeList_.fadeOut(),i.directionsPanel_.removeClass("in");var a=this.el_.find(".rendered-directions").empty();this.directionsService_.route({origin:this.directionsFrom_,destination:this.directionsTo_.getLocation(),travelMode:google.maps.DirectionsTravelMode.DRIVING,unitSystem:i.distance_type},function(t,e){if(i.el_.find("#map-loading").hide(),e==google.maps.DirectionsStatus.OK){g(".asl-p-cont .count-row").addClass("hide"),g(".asl-p-cont #filter-options").addClass("hide"),i.get("view").showing_direction=!0;var o=i.directionsRenderer_;o.setPanel(a[0]),o.setMap(i.get("view").getMap()),o.setDirections(t)}}),this.directionsFrom_=null}},asl_locator.Panel.prototype.featureFilter_changed=function(){this.listenForStoresUpdate_()},asl_locator.PanelOptions=function(){},asl_locator.prototype.locationSearch,asl_locator.PanelOptions.prototype.locationSearchLabel,asl_locator.PanelOptions.prototype.featureFilter,asl_locator.PanelOptions.prototype.directions,asl_locator.PanelOptions.prototype.view}(jQuery),function($,_){var map=null,asl_engine={config:{},helper:{}};if(window.asl_engine=asl_engine,window.asl_configuration){asl_configuration.accordion=!1,asl_configuration.analytics="1"==asl_configuration.analytics,asl_configuration.sort_by_bound="1"==asl_configuration.sort_by_bound,asl_configuration.sort_by_bound=!1,asl_configuration.scroll_wheel="1"==asl_configuration.scroll_wheel,asl_configuration.distance_slider="1"==asl_configuration.distance_slider,asl_configuration.show_categories="0"!=asl_configuration.show_categories,asl_configuration.time_switch="0"!=asl_configuration.time_switch,asl_configuration.category_marker="0"!=asl_configuration.category_marker,asl_configuration.advance_filter="0"!=asl_configuration.advance_filter,asl_configuration.time_24="1"==asl_configuration.time_format,asl_configuration.smooth_pan="1"==asl_configuration.smooth_pan,asl_configuration.week_hours="1"==asl_configuration.week_hours,asl_configuration.user_center="1"==asl_configuration.user_center,asl_configuration.distance_unit="KM"==asl_configuration.distance_unit?asl_configuration.distance_unit:"Miles",asl_configuration.filter_result="1"==asl_configuration.filter_result,asl_configuration.regex=asl_configuration.no_regex?/#|\./gi:/[^a-z0-9\s]/gi,asl_configuration.info_x_offset=asl_configuration.info_x_offset&&!isNaN(asl_configuration.info_x_offset)?parseInt(asl_configuration.info_x_offset):0,asl_configuration.info_y_offset=asl_configuration.info_y_offset&&!isNaN(asl_configuration.info_y_offset)?parseInt(asl_configuration.info_y_offset):0,asl_configuration.enter_key=!0,asl_configuration.category_sort=!0,asl_configuration.stores_limit=asl_configuration.stores_limit&&!isNaN(asl_configuration.stores_limit)?parseInt(asl_configuration.stores_limit):null,asl_configuration.radius_circle="1"==asl_configuration.radius_circle,asl_configuration.mobile_stores_limit=asl_configuration.mobile_stores_limit?parseInt(asl_configuration.mobile_stores_limit):100,asl_configuration.load_all="1",asl_configuration.filter_result=!1,asl_configuration.smooth_pan=!1,window.gm_authFailure=function(){var t=$('<div class="alert alert-danger asl-geo-err"></div>');t.html("This API project is not authorized to use this API. Please ensure this API is activated in the Google Developers."),t.appendTo(".asl-p-cont"),window.setTimeout(function(){t.remove()},5e3)},asl_configuration.no_script&&$(".asl-p-cont p:empty").remove(),asl_configuration.fixed_radius=asl_configuration.fixed_radius&&!isNaN(asl_configuration.fixed_radius)?parseInt(asl_configuration.fixed_radius):null,asl_configuration.is_mob=_isMobileDevice(),"3"==asl_configuration.search_type&&(asl_configuration.search_type="0",asl_configuration.geocoding_only=!0),""!=asl_configuration.full_height&&$("#asl-storelocator").css("height",jQuery(window).height()+"px"),asl_configuration.is_mob&&asl_configuration.mobile_load_bound&&(asl_configuration.load_all="2",asl_configuration.search_type="0"),asl_configuration.is_mob&&asl_configuration.mobile_stores_limit&&(asl_configuration.stores_limit=asl_configuration.mobile_stores_limit&&!isNaN(asl_configuration.mobile_stores_limit)?parseInt(asl_configuration.mobile_stores_limit):null);var asl_lat=asl_configuration.default_lat?parseFloat(asl_configuration.default_lat):39.9217698526,asl_lng=asl_configuration.default_lng?parseFloat(asl_configuration.default_lng):-75.5718432,categories={},asl_date=new Date;asl_configuration.default_lat=asl_lat,asl_configuration.default_lng=asl_lng,asl_configuration.show_opened=!0,$("#asl-dist-unit").html(asl_configuration.distance_unit),asl_engine.helper.asl_leadzero=function(t){return 9<t?""+t:"0"+t},asl_engine.helper.asl_timeConvert=function(t){if(!t)return 0;var e=$.trim(t).toUpperCase();if(/(1[012]|[0-9]):[0-5][0-9]$/.test(e))return(o=Number(e.match(/^(\d+)/)[1]))+(i=Number(e.match(/:(\d+)/)[1]))/100;if(/(1[012]|[1-9]):[0-5][0-9][ ]?(AM|PM)/.test(e)){var o=Number(e.match(/^(\d+)/)[1]),i=Number(e.match(/:(\d+)/)[1]),a=-1!=e.indexOf("PM")?"PM":"AM";return"PM"==a&&o<12&&(o+=12),"AM"==a&&12==o&&(o-=12),o+i/100}return 0},asl_engine.helper.between=function(t,e,o){return e<t&&t<o},asl_engine.helper.implode=function(t,e){for(var o=[],i=0,a=t.length;i<a;i++)t[i]&&o.push(t[i]);return o.join(e)},asl_engine.helper.toObject_=function(t,e){for(var o={},i=0,a=e.length;i<a;i++)o[t[i]]=e[i];return o},asl_engine.helper.distanceCalc=function(t){var e=this.getLocation(),o=asl_locator.toRad_(e.lat()),i=asl_locator.toRad_(e.lng()),a=asl_locator.toRad_(t.lat()),s=a-o,n=asl_locator.toRad_(t.lng())-i,r=Math.sin(s/2)*Math.sin(s/2)+Math.cos(o)*Math.cos(a)*Math.sin(n/2)*Math.sin(n/2);return 6371*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)))},asl_engine.dataSource=function(){this.stores_=[],this.remote_url=ASL_REMOTE.ajax_url},asl_engine.dataSource.prototype.sortDistance=function(o,t){t=t.sort(function(t,e){return t.distanceTo(o)-e.distanceTo(o)})},asl_engine.dataSource.prototype.sortBy=function(o,t){"cat"==o?t.sort(function(t,e){var o=t.props_.cat,i=e.props_.cat,a=t.props_.distance,s=e.props_.distance;return o==i?a<s?-1:s<a?1:0:o<i?-1:1}):t.sort(function(t,e){return t.props_[o]>e.props_[o]?1:e.props_[o]>t.props_[o]?-1:0})},asl_engine.dataSource.prototype.sortByDesc=function(o,t){t.sort(function(t,e){return t.props_[o]<e.props_[o]?1:e.props_[o]<t.props_[o]?-1:0})};var not_initial_load=!1,asl_view=null,asl_panel=null;asl_engine.dataSource.prototype.fetch_remote_data=function(y){var w=this;$(".asl-p-cont .asl-overlay").show();var t={action:"asl_load_stores",nonce:ASL_REMOTE.nonce,load_all:asl_configuration.load_all,layout:asl_configuration.layout?1:0};if(asl_configuration.stores&&(t.stores=asl_configuration.stores),"1"!=asl_configuration.load_all){var e=map.getBounds(),o=e.getNorthEast(),i=e.getSouthWest(),a=e.getCenter();t.lat=a.lat(),t.lng=a.lng(),t.nw=[o.lat(),i.lng()],t.se=[i.lat(),o.lng()]}asl_configuration.category&&(t.category=asl_configuration.category),w.on_call=!0,$.ajax({url:ASL_REMOTE.ajax_url,data:t,type:"GET",dataType:"json",success:function(t){if(w.stores_=w.parseData(t),"2"==asl_configuration.load_all&&$(".asl-reload-map").find("i").removeClass("animate-spin"),$("#asl-storelocator .asl-search-name")[0]&&asl_locator.add_prop_search(t,$("#asl-storelocator .asl-search-name")),"2"==asl_configuration.search_type){var e=$("#asl-storelocator .asl-search-address"),o=[],i=asl_underscore.uniq(t,!1,function(t){return t.city}),a=asl_underscore.uniq(t,!1,function(t){return t.state}),s=asl_underscore.uniq(t,!1,function(t){return t.country}),n=asl_underscore.uniq(t,!1,function(t){return t.postal_code});for(var r in n)n.hasOwnProperty(r)&&o.push({type:"postal_code",title:n[r].postal_code});for(var r in i)i.hasOwnProperty(r)&&o.push({type:"city",title:i[r].city});for(var r in a)a.hasOwnProperty(r)&&o.push({type:"state",title:a[r].state});for(var r in s)s.hasOwnProperty(r)&&o.push({type:"country",title:s[r].country});asl_locator.add_prop_search(o,e)}not_initial_load||((e=$(".asl-p-cont #auto-complete-search,.asl-p-cont .asl-search-address")).after('<button class="asl-search-clr asl-clear-btn hide" type="button"><svg width="12" height="12" viewBox="0 0 12 12" xmlns="https://www.w3.org/2000/svg"><path d="M.566 1.698L0 1.13 1.132 0l.565.566L6 4.868 10.302.566 10.868 0 12 1.132l-.566.565L7.132 6l4.302 4.3.566.568L10.868 12l-.565-.566L6 7.132l-4.3 4.302L1.13 12 0 10.868l.566-.565L4.868 6 .566 1.698z"></path></svg></button>'),e.next().bind("click",function(t){asl_view._location=null,asl_view.reset_measure(e),asl_view._panel.stores_changed(),$(this).addClass("hide")}));var l=w.stores_,_=l[0]?l[0].props_.country:null;w.countries=!1;for(var c=0;c<l.length;c++)if(_!=l[c].props_.country){w.countries=!0;break}if(!not_initial_load){if(not_initial_load=!0,asl_view=new asl_locator.View(map,w,{geolocation:!1,features:w.getDSFeatures()}),asl_panel=new asl_locator.Panel(document.getElementById("asl-list"),{view:asl_view}),asl_view._panel=asl_panel,window.asl_view=asl_view,asl_configuration.smooth_pan){function d(){asl_view.map_w=$(map.getDiv()).width(),asl_view.map_h=$(map.getDiv()).height()}asl_view._overlay=new google.maps.OverlayView,asl_view._overlay.draw=function(){},asl_view._overlay.setMap(map),$(window).resize(d),d()}var p=jQuery(".asl-p-cont #asl-geolocation-agile-modal");if(p.find(".close").bind("click",function(t){p.removeClass("in"),window.setTimeout(function(){p.css("display","none")},300)}),"3"==asl_configuration.prompt_location?asl_view.geolocate_():"0"!=asl_configuration.prompt_location&&(p.css("display","block"),window.setTimeout(function(){p.addClass("in")},300),$(".asl-p-cont #asl-btn-geolocation").bind("click",function(){asl_view.geolocate_(),p.removeClass("in").css("display","none")})),"2"==asl_configuration.prompt_location){var g=null,u=new google.maps.Geocoder,h=h||function(t,e){"OK"==e?(asl_view.measure_distance(t[0].geometry.location,!0,null,t),p.removeClass("in").css("display","none")):console.log("Geocode was not successful for the following reason: "+e)};$("#asl-current-loc").bind("keyup",function(t){if(13==t.keyCode){var e=$.trim(this.value);e&&u.geocode({address:e},h)}}),$("#asl-btn-locate").click(function(t){g&&$("#asl-current-loc").val()&&(asl_view.measure_distance(g.geometry.location,!0,null,g),p.removeClass("in").css("display","none"))});var f=$(".asl-p-cont #asl-current-loc")[0],m={};asl_configuration.google_search_type&&(m.types=["("+asl_configuration.google_search_type+")"]),asl_configuration.country_restrict&&(m.componentRestrictions={country:asl_configuration.country_restrict.toLowerCase()});var v=new google.maps.places.Autocomplete(f,m);asl_configuration.enter_key&&asl_panel.geoCoder(f,function(t,e){"OK"==e&&(g=t[0])}),google.maps.event.addListener(v,"place_changed",function(){var t=this.getPlace();g=t})}$(".asl-p-cont .asl-geo.icon-direction-outline").bind("click",function(t){asl_view.geolocate_()}),asl_configuration.user_center&&asl_view.measure_distance(new google.maps.LatLng(asl_configuration.default_lat,asl_configuration.default_lng))}"1"!=asl_configuration.load_all&&asl_view.dest_coords&&asl_view.measure_distance(asl_view.dest_coords,null,!0),asl_configuration.first_load&&"1"!=asl_configuration.first_load||asl_view.refreshView(!0),$(".asl-p-cont .asl-overlay").hide(),y&&map.panTo(y),w.on_call=!1},error:function(){w.on_call=!1},dataType:"json"}),w.pos=a},asl_engine.dataSource.prototype.load_locator=function(){var that=this;if(!document.getElementById("asl-map-canv"))return!1;var maps_params={center:new google.maps.LatLng(asl_lat,asl_lng),zoom:parseInt(asl_configuration.zoom),scrollwheel:asl_configuration.scroll_wheel,gestureHandling:asl_configuration.gesture_handling||"cooperative",mapTypeId:asl_configuration.map_type};if("false"==asl_configuration.zoomcontrol&&(maps_params.zoomControl=!1),"false"==asl_configuration.maptypecontrol&&(maps_params.mapTypeControl=!1),"false"==asl_configuration.scalecontrol&&(maps_params.scaleControl=!1),"false"==asl_configuration.rotatecontrol&&(maps_params.rotateControl=!1),"false"==asl_configuration.fullscreencontrol&&(maps_params.fullscreenControl=!1),"false"==asl_configuration.streetviewcontrol&&(maps_params.streetViewControl=!1),maps_params.fullscreenControlOptions={position:google.maps.ControlPosition.RIGHT_CENTER},asl_configuration.maxzoom&&!isNaN(asl_configuration.maxzoom)&&(maps_params.maxZoom=parseInt(asl_configuration.maxzoom)),asl_configuration.minzoom&&!isNaN(asl_configuration.minzoom)&&(maps_params.minZoom=parseInt(asl_configuration.minzoom)),map=new google.maps.Map(document.getElementById("asl-map-canv"),maps_params),window.asl_map=map,asl_configuration.reset_button=!0,asl_configuration.reset_button){var $reset_btn=null;function ASLResetMAP(t,e){$reset_btn=$('<span class="asl-reset-map" style="display:none">'+asl_configuration.words.reset_map+"</span>"),t.appendChild($reset_btn[0]),$reset_btn[0].addEventListener("click",function(){e.panTo(new google.maps.LatLng(asl_lat,asl_lng)),e.setZoom(parseInt(asl_configuration.zoom)),$reset_btn[0].style.display="none"})}var centerControlDiv=document.createElement("div"),centerControl=new ASLResetMAP(centerControlDiv,map);centerControlDiv.index=1,map.controls[google.maps.ControlPosition.RIGHT].push(centerControlDiv)}if(asl_configuration.map_layout){var map_style=eval("("+asl_configuration.map_layout+")");map.set("styles",map_style)}window._asl_map_customize&&(_asl_map_customize=JSON.parse(_asl_map_customize),_asl_map_customize.trafic_layer&&1==_asl_map_customize.trafic_layer&&(trafic_layer=new google.maps.TrafficLayer,trafic_layer.setMap(map)),_asl_map_customize.bike_layer&&1==_asl_map_customize.bike_layer&&(bike_layer=new google.maps.BicyclingLayer,bike_layer.setMap(map)),_asl_map_customize.transit_layer&&1==_asl_map_customize.transit_layer&&(transit_layer=new google.maps.TransitLayer,transit_layer.setMap(map)),_asl_map_customize.drawing&&asl_drawing.loadData(_asl_map_customize.drawing,map));var _features=[];for(var i in asl_categories){var cat=asl_categories[i];that.FEATURES_.add(new asl_locator.Feature(cat.id,cat.name,cat.icon,cat.s))}if("1"==asl_configuration.load_all)that.fetch_remote_data();else if("2"==asl_configuration.load_all){var $reload_btn=null,_set_position=null,first_loaded=!1;function ASLReloadMAP(t,e){$reload_btn=$('<span class="asl-reload-map" display="none"><i class="icon-arrows-cw"></i>'+asl_configuration.words.reload_map+"</span>"),t.appendChild($reload_btn[0]),$reload_btn[0].addEventListener("click",function(){$reload_btn.find("i").addClass("animate-spin"),that.fetch_remote_data(_set_position)})}var centerControlDiv=document.createElement("div"),centerControl=new ASLReloadMAP(centerControlDiv,map);centerControlDiv.index=1,map.controls[google.maps.ControlPosition.TOP_CENTER].push(centerControlDiv),google.maps.event.addListener(map,"idle",function(){asl_view&&asl_view.marker_clicked&&(_set_position=asl_view.marker_center,asl_view.marker_clicked=!1),$reload_btn[0].style.display="block",first_loaded||(first_loaded=!0,that.fetch_remote_data())})}else google.maps.event.addListener(map,"idle",function(){var t=null;if(asl_view&&asl_view.marker_clicked)return t=asl_view.marker_center,void(asl_view.marker_clicked=!1);that.fetch_remote_data(t)})},asl_engine.dataSource.prototype.FEATURES_=new asl_locator.FeatureSet,asl_engine.dataSource.prototype.getDSFeatures=function(){return this.FEATURES_},asl_engine.dataSource.prototype.parseData=function(t){var e=[],m=asl_date.getHours()+asl_date.getMinutes()/100,v=asl_date.getDay(),o=asl_categories;asl_categories={};var i=Object.keys(o);for(var a in i)"object"==typeof o[i[a]]&&(asl_categories[String(i[a])]=o[i[a]],asl_categories[i[a]].len=0);var y=["mon","tue","wed","thu","fri","sat","sun"];v={1:"mon",2:"tue",3:"wed",4:"thu",5:"fri",6:"sat",0:"sun"}[v];function s(t){if(t.open_hours){t.open=!1,t.open_hours=JSON.parse(t.open_hours);var e=[];for(var o in y){var i=y[o],a=t.open_hours[i],s=i==v;if("1"==a)s&&(t.open=!0);else if("0"==a)s&&(t.open=!1);else if(a){var n=[];for(var r in a)if(a.hasOwnProperty(r)){var l=a[r].split(" - "),_=l[0],c=l[1],d=0!=_?asl_engine.helper.asl_timeConvert(_):0,p=0!=c?asl_engine.helper.asl_timeConvert(c):24;if(0==p&&(p=24),!t.open&&s&&(t.open=!(!_||!c)&&asl_engine.helper.between(m,d,p)),asl_configuration.time_24){d+=.01,d=parseFloat(d).toFixed(2);var g=String(d).split(".");g[0]=asl_engine.helper.asl_leadzero(parseInt(g[0])),g[1]=asl_engine.helper.asl_leadzero(parseInt(g[1])-1),_=g.join(":"),p+=.01,p=parseFloat(p).toFixed(2);var u=String(p).split(".");u[0]=asl_engine.helper.asl_leadzero(parseInt(u[0])),u[1]=asl_engine.helper.asl_leadzero(parseInt(u[1])-1),c=u.join(":")}else{var h=_.split(":"),f=c.split(":");h[0]&&(h[0]=asl_engine.helper.asl_leadzero(parseInt(h[0]))),_=h.join(":"),f[0]&&(f[0]=asl_engine.helper.asl_leadzero(parseInt(f[0]))),c=f.join(":")}n.push("<span>"+_+" - "+c+"</span>"),s&&(t.start_time=_,t.end_time=c)}e.push('<span><span class="asl-day-lbl">'+asl_configuration.days[i]+':</span><span class="asl-time-hrs">'+n.join("")+"</span></span>")}}t.open_hours=0<e.length?'<span class="asl-week-hrs">'+e.join("")+"</span>":null}else t.open=!0}function n(t){if(t.open_hours){t.open=!1,t.open_hours=JSON.parse(t.open_hours);var e=t.open_hours[v];if(t.open_hours=null,"1"==e)t.open=!0;else if("0"==e)t.open=!1;else if(e){for(var o in t.open_hours=[],e)if(e.hasOwnProperty(o)){var i=e[o].split(" - ");t.start_time=i[0],t.end_time=i[1];var a=0!=t.start_time?asl_engine.helper.asl_timeConvert(t.start_time):0,s=0!=t.end_time?asl_engine.helper.asl_timeConvert(t.end_time):24;if(0==s&&(s=24),t.open||(t.open=!(!t.start_time||!t.end_time)&&asl_engine.helper.between(m,a,s)),asl_configuration.time_24){a+=.01,a=parseFloat(a).toFixed(2);var n=String(a).split(".");n[0]=asl_engine.helper.asl_leadzero(parseInt(n[0])),n[1]=asl_engine.helper.asl_leadzero(parseInt(n[1])-1),t.start_time=n.join(":"),s+=.01,s=parseFloat(s).toFixed(2);var r=String(s).split(".");r[0]=asl_engine.helper.asl_leadzero(parseInt(r[0])),r[1]=asl_engine.helper.asl_leadzero(parseInt(r[1])-1),t.end_time=r.join(":")}else{var l=t.start_time.split(":"),_=t.end_time.split(":");l[0]&&(l[0]=asl_engine.helper.asl_leadzero(parseInt(l[0]))),t.start_time=l.join(":"),_[0]&&(_[0]=asl_engine.helper.asl_leadzero(parseInt(_[0]))),t.end_time=_.join(":")}t.open_hours.push(t.start_time+" - "+t.end_time)}t.open_hours=0<t.open_hours.length?t.open_hours.join(" <br> "):null}}else t.open=!0}for(var r=0;r<t.length;r++){var l=t[r];l.id=parseInt(l.id),l.ordr=!l.ordr||isNaN(l.ordr)?0:parseInt(l.ordr),l.lat=parseFloat(l.lat),l.lng=parseFloat(l.lng),l.logo_id=l.logo_id&&!isNaN(l.logo_id)?parseInt(l.logo_id):l.logo_id;var _=new google.maps.LatLng(l.lat,l.lng);l.open_hours=l.open_hours?l.open_hours:null,l.state||(l.state="");var c=asl_engine.helper.implode([l.city,l.state,l.postal_code],", "),d=[l.street,c];l.address=asl_engine.helper.implode(d," <br> ");var p=l.categories?l.categories.split(","):[],g=[];if(asl_configuration.show_categories){var u=[];for(var h in p){var f=p[h].toString();asl_categories[f]?(asl_categories[f].len++,g.push(asl_categories[f]),u.push(asl_categories[f].name)):delete p[h]}u&&u[0]&&(l.cat=u[0]),l.c_names=asl_engine.helper.implode(u,", "),l.categories=g}l.city=$.trim(l.city),l.country=$.trim(l.country),l.state||(l.state=""),asl_configuration.additional_info||(l.description_2=null),l.marker_id=l.marker_id?l.marker_id.toString():"",asl_configuration.week_hours?s(l):n(l);var w=new asl_locator.Store(l.id,_,p,l);e.push(w)}return e};var data_source=new asl_engine.dataSource;data_source.getStores=function(t,e,o,i){for(var a,s=[],n=0;a=this.stores_[n];n++)a.hasAnyCategory(e)&&s.push(a);o(s)},data_source.load_locator()}}(jQuery,asl_underscore)}function InfoBox(t){t=t||{},google.maps.OverlayView.apply(this,arguments),this.content_=t.content||"",this.disableAutoPan_=t.disableAutoPan||!1,this.maxWidth_=t.maxWidth||0,this.pixelOffset_=t.pixelOffset||new google.maps.Size(0,0),this.position_=t.position||new google.maps.LatLng(0,0),this.zIndex_=t.zIndex||null,this.boxClass_=t.boxClass||"infoBox",this.boxStyle_=t.boxStyle||{},this.closeBoxMargin_=t.closeBoxMargin||"2px",this.closeBoxURL_=t.closeBoxURL||"https://www.google.com/intl/en_us/mapfiles/close.gif",""===t.closeBoxURL&&(this.closeBoxURL_=""),this.infoBoxClearance_=t.infoBoxClearance||new google.maps.Size(1,1),void 0===t.visible&&(void 0===t.isHidden?t.visible=!0:t.visible=!t.isHidden),this.isHidden_=!t.visible,this.alignBottom_=t.alignBottom||!1,this.pane_=t.pane||"floatPane",this.enableEventPropagation_=t.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.moveListener_=null,this.contextListener_=null,this.eventListeners_=null,this.fixedWidthSet_=null}function _isMobileDevice(){var t,e=!1;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e}});